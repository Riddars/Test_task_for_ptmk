# Справочник сотрудников
О проекте
Это консольное приложение для работы со справочником сотрудников. Проект создан как тестовое задание для ПТМК.

## Приложение умеет:

Создавать таблицу в БД  
Добавлять отдельных сотрудников  
Показывать всех сотрудников с вычислением возраста  
Добавлять миллион тестовых записей  
Выполнять поиск с замером времени  
Оптимизировать запросы и сравнивать результаты  

## Запуск проекта
Создайте БД PostgreSQL с именем `employee_directory`
Настройте параметры подключения в файле `config.py` при необходимости
Установите зависимости `requirements.txt`
Запускайте приложение через командную строку, указывая нужный режим


## Структура проекта

Проект состоит из двух основных файлов:

- **config.py** - настройки подключения к бд
- **main.py** - основной код приложения

## Классы в проекте

### Database - отвечает за подключение к базе данных и выполнение запросов
- `connect()` - подключение к PostgreSQL
- `close()` - закрытие соединения
- `query_the_database()` - выполнение SQL-запросов
- `create_table()` - создание таблицы сотрудников
- `create_index()` и `drop_index()` - работа с индексами

### Employee - хранит данные о сотрнуднике и методы для работы с ними
- Валидация ФИО, даты рождения и пола
- `add_employee()` - метод для добавления в БД
- `get_age()` - расчет возраста сотрудника

### EmployeeManager - класс для массовой работы с данными
- `generate_batch_employees()` - генерация случайных сотрудников
- `add_one_million_employees()` - дабавление миллиона записей в БД

### EmployeeView - класс для отображения данных
- `display_employees_with_age()` - выводит список всех сотрудников
- `find_employee_F_without_index()` и `find_employee_F_with_index()` - поиск с замером времени

## Режимы работы

Приложение запускается из командной строки с указанием режима работы:

### Режим 1: Создание таблицы

```
python main.py 1
```
Создает таблицу employee если её не существует с полями: id, full_name, birth_date, gender.

### Режим 2: Добавление сотрудника

```
python main.py 2 "Ivanov Ivan Ivanovich" 1990-10-20 Male
```
Добавляет нового сотрудника, проверяя валидность данных. ФИО должно быть на английском.

### Режим 3: Вывод всех сотрудников

```
python main.py 3
```
Выводит форматированную таблицу всех сотрудников с рассчитанным возрастом в годах.

### Режим 4: Массовое добавление записей

```
python main.py 4
```
Генерирует и добавляет 1000000 записей + 100 мужчин с фамилиями на букву "F". Добавляет записи пакетами для быстродействия.

### Режим 5: Замер скорости поиска

```
python main.py 5
```
Выполняет поиск мужчин с фамилией, начинающейся на "F", и выводит время выполнения. Этот режим используется как базовый для сравения с оптимизированным поиском.

### Режим 6: Оптимизация и сравнение

```
python main.py 6
```
Сравнивает скорость запроса без индекса и с индексом. Создает индекс для полей gender и full_name, запускает поиск, и показывает разницу во времени.


## Примеры использования

### Последовательность действий для демонстрации:

1. Сначала создаем таблицу:
```
python main.py 1
```

2. Добавим тестовых сотрудников:
```
python main.py 2 "Ivanov Ivan Ivanovich" 1985-03-15 Male
python main.py 2 "Foster Peter John" 1990-12-05 Male
python main.py 2 "Smith Jane Alexandra" 1987-05-22 Female
```

3. Просмотрим всех добавленных сотрудников:
```
python main.py 3
```

4. Заполним таблицу миллионом записей (это займет время):
```
python main.py 4
```

5. Выполним поиск без оптимизации:
```
python main.py 5
```

6. Проверим результаты оптимизации:
```
python main.py 6
```

## Оптимизация

Для оптимизации поиска используется создание индекса по двум полям: gender и full_name.

```sql
CREATE INDEX idx_gender_fullname ON employees (gender, full_name);
```

Индекс ускоряет выполнение следующего запроса:

```sql
SELECT * FROM employees 
WHERE gender = 'Male' AND full_name LIKE 'F%'
ORDER BY full_name;
```